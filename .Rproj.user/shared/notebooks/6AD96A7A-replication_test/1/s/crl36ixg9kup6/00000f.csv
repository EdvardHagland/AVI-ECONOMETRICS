"0","# --- INTENT: Prepare data and load library for ordered logit models. ---"
"0","# --- EFFECT: Converts mg.asp to an ordered factor using mig_long and loads the MASS package. ---"
"0","message(""Running Robustness Check 2: Ordered Logit Models..."")"
"0","library(MASS) # For polr()"
"0",""
"0","# Ensure mig_long exists and has mg.asp"
"0","if (!exists(""mig_long"") || !""mg.asp"" %in% names(mig_long)) {"
"0","  stop(""Error in robust-ologit-setup: mig_long data frame not found or missing 'mg.asp' column."")"
"0","}"
"0",""
"0","# Convert outcome to ordered factor if not already done"
"0","if (!""mg.asp_ord"" %in% names(mig_long) || !is.ordered(mig_long$mg.asp_ord)){"
"0","  mig_long <- mig_long %>%"
"0","    mutate(mg.asp_ord = factor(mg.asp, ordered = TRUE))"
"0","  message(""'mg.asp' converted to ordered factor 'mg.asp_ord'."")"
"0","} else {"
"0","  message(""'mg.asp_ord' already exists as an ordered factor."")"
"0","}"
