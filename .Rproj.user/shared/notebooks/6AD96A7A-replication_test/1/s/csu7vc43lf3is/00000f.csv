"0","# Load necessary packages"
"0","library(sandwich)  # For robust standard errors"
"0","library(lmtest)    # For coeftest"
"0",""
"0","# Define data subsets outside the function so they're available in the global environment"
"0","w2_data <- subset(mig_long, wave!=3 & nonmissing2)"
"0","w3_data <- subset(mig_long, wave!=2 & nonmissing3)"
"0",""
"0","# Function to create a clean table directly"
"0","create_cluster_table <- function() {"
"0","  # Standard results for Wave 2"
"0","  w2_coef <- coef(summary(asp.did.w2))[""treat.dum:post.dum"", ""Estimate""]"
"0","  w2_se <- coef(summary(asp.did.w2))[""treat.dum:post.dum"", ""Std. Error""]"
"0","  w2_p <- coef(summary(asp.did.w2))[""treat.dum:post.dum"", ""Pr(>|t|)""]"
"0","  "
"0","  # Clustered results for Wave 2"
"0","  w2_cl <- coeftest(asp.did.w2, vcov = vcovCL(asp.did.w2, cluster = w2_data$Region))"
"0","  w2_cl_se <- w2_cl[""treat.dum:post.dum"", ""Std. Error""]"
"0","  w2_cl_p <- w2_cl[""treat.dum:post.dum"", ""Pr(>|t|)""]"
"0","  "
"0","  # Standard results for Wave 3"
"0","  w3_coef <- coef(summary(asp.did.w3))[""treat.dum:post.dum"", ""Estimate""]"
"0","  w3_se <- coef(summary(asp.did.w3))[""treat.dum:post.dum"", ""Std. Error""]"
"0","  w3_p <- coef(summary(asp.did.w3))[""treat.dum:post.dum"", ""Pr(>|t|)""]"
"0","  "
"0","  # Clustered results for Wave 3"
"0","  w3_cl <- coeftest(asp.did.w3, vcov = vcovCL(asp.did.w3, cluster = w3_data$Region))"
"0","  w3_cl_se <- w3_cl[""treat.dum:post.dum"", ""Std. Error""]"
"0","  w3_cl_p <- w3_cl[""treat.dum:post.dum"", ""Pr(>|t|)""]"
"0","  "
"0","  # Create table with basic R"
"0","  result <- data.frame("
"0","    Model = c(""Wave 2 DiD"", ""Wave 3 DiD""),"
"0","    Coef = round(c(w2_coef, w3_coef), 3),"
"0","    Std_SE = round(c(w2_se, w3_se), 3),"
"0","    Std_p = round(c(w2_p, w3_p), 3),"
"0","    Clust_SE = round(c(w2_cl_se, w3_cl_se), 3),"
"0","    Clust_p = round(c(w2_cl_p, w3_cl_p), 3),"
"0","    SE_Ratio = round(c(w2_cl_se/w2_se, w3_cl_se/w3_se), 2)"
"0","  )"
"0","  "
"0","  return(result)"
"0","}"
"0",""
"0","# Create table and format with kable"
"0","cluster_table <- create_cluster_table()"
"0",""
"0","# Format with kable and styling matching other tables"
"0","cluster_table %>%"
"0","  kbl("
"0","    caption = ""Effect of Regional Clustering on Standard Errors (DiD Treatment Effect)"","
"0","    col.names = c(""Model"", ""Coefficient"", ""Standard SE"", ""Standard p"", "
"0","                 ""Clustered SE"", ""Clustered p"", ""SE Ratio""),"
"0","    digits = c(0, 3, 3, 3, 3, 3, 2),"
"0","    align = c(""l"", ""r"", ""r"", ""r"", ""r"", ""r"", ""r""),"
"0","    booktabs = TRUE"
"0","  ) %>%"
"0","  kable_styling("
"0","    latex_options = c(""striped"", ""HOLD_position""), "
"0","    bootstrap_options = ""striped"","
"0","    position = ""center"","
"0","    font_size = 9,"
"0","    full_width = FALSE"
"0","  ) %>%"
"0","  footnote("
"0","    general = ""SE Ratio = Clustered SE / Standard SE. Wave 2 p-value changes from 0.009 to 0.056."","
"0","    footnote_as_chunk = TRUE"
"0","  )"
