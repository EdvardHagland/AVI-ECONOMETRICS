"0","# --- INTENT: Estimate Ordered Logit DiD models. ---"
"0","# --- EFFECT: Runs polr() models using mig_long with Hess=TRUE for standard errors. ---"
"0","# Note: We use the weighted specification here, matching the main paper's preferred approach."
"0",""
"0","# Define glance.polr method for modelsummary"
"0","glance.polr <- function(x, ...) {"
"0","  data.frame(nobs = x$n)"
"0","}"
"0",""
"0","# Define the formula for polr"
"0","ologit_formula <- mg.asp_ord ~ treat.dum * post.dum + factor(Region)"
"0",""
"0","# Model R2a: Ordered Logit DiD (Baseline vs Wave 2, Weighted)"
"0","data_w2_ologit <- subset(mig_long, wave != 3 & nonmissing2) # Use mig_long"
"0","# Ensure weights are positive and handle potential NAs"
"0","data_w2_ologit <- data_w2_ologit %>%"
"0","  filter(!is.na(wt2) & wt2 > 0 & complete.cases(.[, c(""mg.asp_ord"", ""treat.dum"", ""post.dum"", ""Region"")]))"
"0",""
"0","ologit.did.w2 <- NULL # Initialize as NULL"
"0","if(nrow(data_w2_ologit) > 0) {"
"0","  ologit.did.w2 <- tryCatch({"
"0","      polr(ologit_formula, data = data_w2_ologit, weights = wt2, Hess = TRUE)"
"0","    }, error = function(e) {"
"0","      message(""Error fitting Wave 2 Ordered Logit: "", e$message); return(NULL)"
"0","  })"
"0","  if (!is.null(ologit.did.w2)) print(summary(ologit.did.w2)) # DEBUG PRINT"
"0","} else {"
"0","  message(""Skipping Wave 2 Ordered Logit: No valid data after filtering."")"
"0","}"
"1","Call:
"
"1","polr(formula = ologit_formula, data = data_w2_ologit, weights = wt2, 
"
"1","    Hess = TRUE)
"
"1","
Coefficients:
"
"1","                                "
"1","    Value"
"1"," Std. Error"
"1"," t value"
"1","
treat.dum                       "
"1"," -0.02581"
"1","     0.1320"
"1"," -0.1956"
"1","
post.dum                        "
"1","  0.03456"
"1","     0.1312"
"1","  0.2633"
"1","
factor(Region)Lower River Region"
"1"," -0.26353"
"1","     0.1942"
"1"," -1.3573"
"1","
factor(Region)Upper River Region"
"1"," -0.46270"
"1","     0.1444"
"1"," -3.2038"
"1","
factor(Region)West Coast Region "
"1"," -0.11283"
"1","     0.1154"
"1"," -0.9780"
"1","
treat.dum:post.dum              "
"1"," -0.54828"
"1","     0.1887"
"1"," -2.9059"
"1","
"
"1","
Intercepts:
"
"1","   "
"1"," Value   "
"1"," Std. Error"
"1"," t value "
"1","
1|2"
"1","  -3.9476"
"1","   0.1911  "
"1"," -20.6550"
"1","
2|3"
"1","  -1.4355"
"1","   0.1097  "
"1"," -13.0903"
"1","
3|4"
"1","  -0.5873"
"1","   0.1032  "
"1","  -5.6908"
"1","
4|5"
"1","   1.3718"
"1","   0.1097  "
"1","  12.5023"
"1","
"
"1","
Residual Deviance:"
"1"," "
"1","4142.218"
"1"," "
"1","
"
"1","AIC:"
"1"," "
"1","4162.218"
"1"," "
"1","
"
"0","# Model R2b: Ordered Logit DiD (Baseline vs Wave 3, Weighted)"
"0","data_w3_ologit <- subset(mig_long, wave != 2 & nonmissing3) # Use mig_long"
"0","data_w3_ologit <- data_w3_ologit %>%"
"0","  filter(!is.na(wt3) & wt3 > 0 & complete.cases(.[, c(""mg.asp_ord"", ""treat.dum"", ""post.dum"", ""Region"")]))"
"0",""
"0","ologit.did.w3 <- NULL # Initialize as NULL"
"0","if(nrow(data_w3_ologit) > 0) {"
"0","  ologit.did.w3 <- tryCatch({"
"0","      polr(ologit_formula, data = data_w3_ologit, weights = wt3, Hess = TRUE)"
"0","    }, error = function(e) {"
"0","      message(""Error fitting Wave 3 Ordered Logit: "", e$message); return(NULL)"
"0","  })"
"0","  if (!is.null(ologit.did.w3)) print(summary(ologit.did.w3)) # DEBUG PRINT"
"0","} else {"
"0","  message(""Skipping Wave 3 Ordered Logit: No valid data after filtering."")"
"0","}"
"1","Call:
"
"1","polr(formula = ologit_formula, data = data_w3_ologit, weights = wt3, 
"
"1","    Hess = TRUE)
"
"1","
Coefficients:
"
"1","                                "
"1","    Value"
"1"," Std. Error"
"1"," t value"
"1","
treat.dum                       "
"1"," -0.10565"
"1","     0.1317"
"1"," -0.8022"
"1","
post.dum                        "
"1"," -0.09559"
"1","     0.1311"
"1"," -0.7293"
"1","
factor(Region)Lower River Region"
"1"," -0.22113"
"1","     0.2033"
"1"," -1.0877"
"1","
factor(Region)Upper River Region"
"1"," -0.38699"
"1","     0.1433"
"1"," -2.7001"
"1","
factor(Region)West Coast Region "
"1"," -0.03962"
"1","     0.1138"
"1"," -0.3482"
"1","
treat.dum:post.dum              "
"1"," -0.21664"
"1","     0.1867"
"1"," -1.1603"
"1","
"
"1","
Intercepts:
"
"1","   "
"1"," Value   "
"1"," Std. Error"
"1"," t value "
"1","
1|2"
"1","  -3.7693"
"1","   0.1810  "
"1"," -20.8220"
"1","
2|3"
"1","  -1.4508"
"1","   0.1112  "
"1"," -13.0500"
"1","
3|4"
"1","  -0.5119"
"1","   0.1042  "
"1","  -4.9103"
"1","
4|5"
"1","   1.3906"
"1","   0.1109  "
"1","  12.5368"
"1","
"
"1","
Residual Deviance:"
"1"," "
"1","4242.937"
"1"," "
"1","
"
"1","AIC:"
"1"," "
"1","4262.937"
"1"," "
"1","
"
"0","message(""Ordered logit models estimated (if data allowed)."")"
