"0","# --- INTENT: Estimate DiD models replacing region FE with baseline covariates. ---"
"0","# --- EFFECT: Runs four lm() models using the original mig_long dataset. ---"
"0","message(""Running Robustness Check 1: Covariate Adjustment Models..."")"
"0",""
"0","# Define baseline covariates (already in mig_long)"
"0","baseline_controls <- c(""age"", ""educ"", ""male"", ""Score"")"
"0","baseline_formula_part <- paste(baseline_controls, collapse = "" + "")"
"0",""
"0","# Ensure mig_long exists before proceeding"
"0","if (!exists(""mig_long"")) {"
"0","  stop(""Error in robust-covariate-adj-models: mig_long data frame not found."")"
"0","}"
"0",""
"0","# Model R1a: DiD (Baseline vs Wave 2, Weighted, Covariates)"
"0","asp.did.w2.cov <- lm(as.formula(paste(""mg.asp ~ treat.dum*post.dum +"", baseline_formula_part)),"
"0","                     data=subset(mig_long, wave!=3 & nonmissing2), # Use mig_long"
"0","                     weights=wt2)"
"0",""
"0","# Model R1b: DiD (Baseline vs Wave 2, Unweighted, Covariates)"
"0","asp.did.w2.cov_unw <- lm(as.formula(paste(""mg.asp ~ treat.dum*post.dum +"", baseline_formula_part)),"
"0","                         data=subset(mig_long, wave!=3 & nonmissing2)) # Use mig_long"
"0",""
"0","# Model R1c: DiD (Baseline vs Wave 3, Weighted, Covariates)"
"0","asp.did.w3.cov <- lm(as.formula(paste(""mg.asp ~ treat.dum*post.dum +"", baseline_formula_part)),"
"0","                     data=subset(mig_long, wave!=2 & nonmissing3), # Use mig_long"
"0","                     weights=wt3)"
"0",""
"0","# Model R1d: DiD (Baseline vs Wave 3, Unweighted, Covariates)"
"0","asp.did.w3.cov_unw <- lm(as.formula(paste(""mg.asp ~ treat.dum*post.dum +"", baseline_formula_part)),"
"0","                         data=subset(mig_long, wave!=2 & nonmissing3)) # Use mig_long"
"0",""
"0","message(""Covariate adjustment models estimated."")"
