"0","# Load necessary packages"
"0","library(sandwich)  # For robust standard errors"
"0","library(lmtest)    # For coeftest"
"0",""
"0","# Define a function to extract key coefficient from models with different SEs"
"0","extract_coef_comparison <- function(model, cluster_var, coef_name=""treat.dum:post.dum"") {"
"0","  # Standard model results"
"0","  std_coef <- coef(summary(model))[coef_name, ""Estimate""]"
"0","  std_se <- coef(summary(model))[coef_name, ""Std. Error""]"
"0","  std_p <- coef(summary(model))[coef_name, ""Pr(>|t|)""]"
"0","  "
"0","  # Clustered SEs"
"0","  clust_results <- coeftest(model, vcov = vcovCL(model, cluster = cluster_var))"
"0","  clust_se <- clust_results[coef_name, ""Std. Error""]"
"0","  clust_p <- clust_results[coef_name, ""Pr(>|t|)""]"
"0","  "
"0","  # Create result row"
"0","  data.frame("
"0","    Coefficient = std_coef,"
"0","    Standard_SE = std_se,"
"0","    Standard_p = std_p,"
"0","    Clustered_SE = clust_se, "
"0","    Clustered_p = clust_p,"
"0","    SE_Ratio = clust_se/std_se"
"0","  )"
"0","}"
"0",""
"0","# Extract results for Wave 2 models"
"0","w2_data <- subset(mig_long, wave!=3 & nonmissing2)"
"0","w2_cluster <- w2_data$Region"
"0","w2_comparison <- extract_coef_comparison(asp.did.w2, w2_cluster)"
"0",""
"0","# Extract results for Wave 3 models"
"0","w3_data <- subset(mig_long, wave!=2 & nonmissing3)"
"0","w3_cluster <- w3_data$Region"
"0","w3_comparison <- extract_coef_comparison(asp.did.w3, w3_cluster)"
"0",""
"0","# Combine into a data frame"
"0","se_results <- rbind("
"0","  data.frame(Model = ""Wave 2 DiD (weighted)"", w2_comparison),"
"0","  data.frame(Model = ""Wave 3 DiD (weighted)"", w3_comparison)"
"0",")"
"0",""
"0","# Display the comparison table"
"0","se_results %>%"
"0","  kbl("
"0","    caption = ""Comparison of Standard vs. Clustered SEs for DiD Treatment Effect"","
"0","    col.names = c(""Model"", ""Coef."", ""Std. SE"", ""Std. p-value"", "
"0","                  ""Clust. SE"", ""Clust. p-value"", ""SE Ratio""),"
"0","    digits = c(0, 3, 3, 3, 3, 3, 2),"
"0","    align = c(""l"", ""r"", ""r"", ""r"", ""r"", ""r"", ""r""),"
"0","    booktabs = TRUE"
"0","  ) %>%"
"0","  kable_styling(latex_options = c(""striped"", ""HOLD_position""), "
"0","                bootstrap_options = ""striped"") %>%"
"0","  footnote("
"0","    general = c(""SE Ratio = Clustered SE / Regular SE. Ratio > 1 indicates standard errors are larger when clustering."","
"0","               ""Results are for the key 'Treat Ã— Post' coefficient only.""),"
"0","    footnote_as_chunk = TRUE,"
"0","    escape = FALSE"
"0","  )"
"2","Error in file.exists(path) : 
  file name conversion problem -- name too long?
"
