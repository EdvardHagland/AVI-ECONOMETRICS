"0","# --- INTENT: Estimate the OLS models needed for Table 2a and 2b. ---"
"0","# --- EFFECT: Runs six lm() models and stores them in separate variables. ---"
"0","# message(""OLS time for Table 2. Difference-in-means, diff-in-diff, weights, regions... why did I have to *replicate* this, not just run it? omg ffs."")"
"0","message(""Running Table 2 OLS models..."")"
"2","Running Table 2 OLS models...
"
"0","# Load necessary libraries (dplyr likely loaded in setup)"
"0","# library(dplyr) "
"0",""
"0","# Ensure mig_long is prepared (from setup chunk or previous steps)"
"0","if (!exists(""mig_long"") || !""post.dum"" %in% names(mig_long)) {"
"0","  warning(""mig_long not found or post.dum missing. Rerunning preparation step."")"
"0","  if (!exists(""mig_long"")) {"
"0","      mig_long <- read_csv(file.path(data_path, ""mig.long.csv""), show_col_types = FALSE)"
"0","  }"
"0","  mig_long <- mig_long %>%"
"0","    mutate(post.dum = ifelse(wave > 1, 1, 0))"
"0","}"
"0",""
"0","# --- Estimate Models (using nonmissing2/nonmissing3 for exact replication) --- "
"0",""
"0","# Model 1: Difference-in-Means (Wave 2 only)"
"0","asp.w2 <- lm(mg.asp ~ treat.dum + factor(Region), "
"0","             data=subset(mig_long, wave==2 & nonmissing2), "
"0","             weights=wt2)"
"0",""
"0","# Model 2: Difference-in-Differences (Baseline vs Wave 2, Weighted)"
"0","asp.did.w2 <- lm(mg.asp ~ treat.dum*post.dum + factor(Region), "
"0","                 data=subset(mig_long, wave!=3 & nonmissing2), "
"0","                 weights=wt2"
"0","                 )"
"0",""
"0","# Model 3: Difference-in-Means (Wave 3 only)"
"0","asp.w3 <- lm(mg.asp ~ treat.dum + factor(Region), "
"0","             data=subset(mig_long, wave==3 & nonmissing3), "
"0","             weights=wt3)"
"0",""
"0","# Model 4: Difference-in-Differences (Baseline vs Wave 3, Weighted)"
"0","asp.did.w3 <- lm(mg.asp ~ treat.dum*post.dum + factor(Region), "
"0","                 data=subset(mig_long, wave!=2 & nonmissing3), "
"0","                 weights=wt3 "
"0","                 )"
"0",""
"0","# Model 2 (Unweighted): Difference-in-Differences (Baseline vs Wave 2)"
"0","asp.did.w2_unw <- lm(mg.asp ~ treat.dum*post.dum + factor(Region), "
"0","                     data=subset(mig_long, wave!=3 & nonmissing2) "
"0","                     )"
"0",""
"0","# Model 4 (Unweighted): Difference-in-Differences (Baseline vs Wave 3)"
"0","asp.did.w3_unw <- lm(mg.asp ~ treat.dum*post.dum + factor(Region), "
"0","                     data=subset(mig_long, wave!=2 & nonmissing3) "
"0","                     )"
